{
  "fhirVersion": "R4",
  "processingErrors": "raise",
  "fhirPathRules": [
    {
      "path": "Observation.valueQuantity.value",
      "method": "differentialPrivacy",
      "epsilon": 0.1,
      "delta": 0.00001,
      "mechanism": "laplace",
      "sensitivity": 1.0,
      "description": "Add Laplace noise to numerical observations"
    },
    {
      "path": "Observation.component.valueQuantity.value",
      "method": "differentialPrivacy",
      "epsilon": 0.1,
      "delta": 0.00001,
      "mechanism": "laplace",
      "sensitivity": 1.0
    },
    {
      "path": "Patient.identifier",
      "method": "cryptoHash",
      "hashFunction": "SHA256",
      "hmacKey": "$HMAC_KEY"
    },
    {
      "path": "Patient.name",
      "method": "redact"
    },
    {
      "path": "Patient.birthDate",
      "method": "dateShift",
      "dateShiftKey": "$DATE_SHIFT_KEY",
      "dateShiftRange": 50
    },
    {
      "path": "Patient.address",
      "method": "redact"
    },
    {
      "path": "Patient.telecom",
      "method": "redact"
    },
    {
      "path": "Observation.subject",
      "method": "cryptoHash",
      "hashFunction": "SHA256",
      "hmacKey": "$HMAC_KEY"
    }
  ],
  "parameters": {
    "privacyBudget": {
      "totalEpsilon": 1.0,
      "warnThreshold": 0.8
    }
  }
}
